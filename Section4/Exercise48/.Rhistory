setwd("C:\\Users\\zc3763\\Dropbox\\Courses\\18SP\\SDS383D\\Section5\\exercise_5_1")
library(mvtnorm)
library(MASS)
profitData = read.csv("restaurants.csv",header = TRUE)
N = 1000
View(profitData)
View(profitData)
setwd("C:\\Users\\zc3763\\Dropbox\\Courses\\18SP\\SDS383D\\Section5\\exercise_5_1")
library(mvtnorm)
library(MASS)
profitData = read.csv("restaurants.csv",header = TRUE)
N = 1000
X = as.matrix(profitData$SeatingCapacity)
Y = as.matrix(profitData$Profit)
intercept = rep(1,nrow(X))
X = cbind(intercept,X)
X = cbind(X,profitData$DinnerService)
mu_n = solve(t(X) %*% X + diag(1,ncol(X))) %*% (t(X) %*% Y)
Sigma_nw = solve(t(X) %*% X + diag(1,ncol(X)))
orate = 1 + 0.5 * (t(Y) %*% Y - t(mu_n) %*% (t(X) %*% X + diag(1,ncol(X),ncol(X))) %*% mu_n)
beta = matrix(0,ncol(X),N + 1)
omega = rgamma(N,shape = (1 + 0.5 * (nrow(X) + ncol(X))), rate = orate)
for (index in 1:N){
beta[,index + 1] = t(rmvnorm(1, mean = mu_n, sigma = Sigma_nw / omega[index]))
}
beta = beta[,500:ncol(beta)]
betaSelect = rowMeans(beta)
yBayes = X %*% betaSelect
residBayes = Y - yBayes
mean(residBayes ** 2)
hist(residBayes)
plot(yBayes)
hist(residBayes)
betaSelect
View(X)
View(X)
View(yBayes)
View(yBayes)
View(yBayes)
View(yBayes)
source('C:/Users/zc3763/Dropbox/Courses/18SP/SDS383D/Section5/exercise_5_1/exercise 2.12allData.r')
plot(beta[,1])
View(beta)
View(beta)
View(beta[1,])
plot(beta[1,])
setwd("C:\\Users\\zc3763\\Dropbox\\Courses\\18SP\\SDS383D\\Section5\\exercise_5_1")
library(mvtnorm)
library(MASS)
profitData = read.csv("restaurants.csv",header = TRUE)
N = 1000
X = as.matrix(profitData$SeatingCapacity)
Y = as.matrix(profitData$Profit)
intercept = rep(1,nrow(X))
X = cbind(intercept,X)
X = cbind(X,profitData$DinnerService)
mu_n = solve(t(X) %*% X + diag(1,ncol(X))) %*% (t(X) %*% Y)
Sigma_nw = solve(t(X) %*% X + diag(1,ncol(X)))
orate = 1 + 0.5 * (t(Y) %*% Y - t(mu_n) %*% (t(X) %*% X + diag(1,ncol(X),ncol(X))) %*% mu_n)
beta = matrix(0,ncol(X),N + 1)
omega = rgamma(N,shape = (1 + 0.5 * (nrow(X) + ncol(X))), rate = orate)
for (index in 1:N){
beta[,index + 1] = t(rmvnorm(1, mean = mu_n, sigma = Sigma_nw / omega[index]))
}
plot(beta[1,])
plot(beta[2,])
plot(beta[3,])
beta = beta[,500:ncol(beta)]
betaSelect = rowMeans(beta)
yBayes = X %*% betaSelect
residBayes = Y - yBayes
mean(residBayes ** 2)
hist(residBayes)
hist(residBayes,breaks = "50")
source('C:/Users/zc3763/Dropbox/Courses/18SP/SDS383D/Section5/exercise_5_1/exercise 2.12allData.r')
source('C:/Users/zc3763/Dropbox/Courses/18SP/SDS383D/Section5/exercise_5_1/exercise 2.12allData.r')
source('C:/Users/zc3763/Dropbox/Courses/18SP/SDS383D/Section5/exercise_5_1/exercise5_1.r')
rm(list=ls())
source('C:/Users/zc3763/Dropbox/Courses/18SP/SDS383D/Section5/exercise_5_1/exercise5_1.r')
source('C:/Users/zc3763/Dropbox/Courses/18SP/SDS383D/Section5/exercise_5_1/exercise5_1.r')
source('C:/Users/zc3763/Dropbox/Courses/18SP/SDS383D/Section5/exercise_5_1/exercise5_1.r')
source('C:/Users/zc3763/Dropbox/Courses/18SP/SDS383D/Section4/Exercise48/run_gp_regression.R')
source('C:/Users/zc3763/Dropbox/Courses/18SP/SDS383D/Section4/Exercise48/run_gp_regression.R')
source('C:/Users/Zicheng Cai/Dropbox/Courses/18SP/SDS383D/Section4/Exercise48/run_gp_regression.R')
aaa = extract(fit)
View(aaa)
View(aaa)
plot(aaa[["f_predict"]])
plot(aa[["y_predict"]])
plot(aaa[["y_predict"]])
quantile(aaa[["y_predict"]],c(0.025 0.975))
quantile(aaa[["y_predict"]],c(0.025,0.975))
